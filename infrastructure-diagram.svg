<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 900">
  <defs>
    <linearGradient id="serverGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#1a1a2e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#16213e;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="ciGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#0f3460;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1a1a2e;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="appGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#533483;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#0f3460;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="1200" height="900" fill="#0a0a0f"/>
  
  <!-- Title -->
  <text x="600" y="40" text-anchor="middle" fill="#e94560" font-family="Arial, sans-serif" font-size="24" font-weight="bold">Tech Citizen SW Gateway - Infrastructure</text>
  
  <!-- Internet Cloud -->
  <ellipse cx="600" cy="100" rx="120" ry="35" fill="#1a1a2e" stroke="#e94560" stroke-width="2"/>
  <text x="600" y="105" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="14">Internet / Users</text>
  
  <!-- Cloudflare -->
  <rect x="500" y="150" width="200" height="50" rx="8" fill="#f38020" filter="url(#shadow)"/>
  <text x="600" y="180" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Cloudflare (DNS + WAF)</text>
  
  <!-- Arrow from Internet to Cloudflare -->
  <line x1="600" y1="135" x2="600" y2="150" stroke="#e94560" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Hetzner Server Box -->
  <rect x="50" y="230" width="1100" height="640" rx="15" fill="url(#serverGrad)" stroke="#e94560" stroke-width="3" filter="url(#shadow)"/>
  <text x="600" y="260" text-anchor="middle" fill="#e94560" font-family="Arial, sans-serif" font-size="18" font-weight="bold">Hetzner CPX32 (8GB RAM) - tech-citizen.me</text>
  
  <!-- Arrow from Cloudflare to Server -->
  <line x1="600" y1="200" x2="600" y2="230" stroke="#e94560" stroke-width="2"/>
  
  <!-- Caddy Reverse Proxy -->
  <rect x="400" y="280" width="400" height="60" rx="8" fill="#00d4aa" filter="url(#shadow)"/>
  <text x="600" y="305" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Caddy (Reverse Proxy + TLS)</text>
  <text x="600" y="325" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="11">:80, :443 → gateway:3042, keycloak:8080, grafana:3000</text>
  
  <!-- CI/CD Section -->
  <rect x="70" y="360" width="280" height="230" rx="10" fill="url(#ciGrad)" stroke="#4ecca3" stroke-width="2"/>
  <text x="210" y="385" text-anchor="middle" fill="#4ecca3" font-family="Arial, sans-serif" font-size="14" font-weight="bold">CI/CD (Woodpecker)</text>
  
  <!-- Woodpecker Server -->
  <rect x="90" y="400" width="110" height="50" rx="5" fill="#4ecca3" filter="url(#shadow)"/>
  <text x="145" y="420" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Server</text>
  <text x="145" y="438" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="10">~100MB</text>
  
  <!-- Woodpecker Agent -->
  <rect x="220" y="400" width="110" height="50" rx="5" fill="#4ecca3" filter="url(#shadow)"/>
  <text x="275" y="420" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Agent</text>
  <text x="275" y="438" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="10">~30MB</text>
  
  <!-- CI Pipeline Box -->
  <rect x="90" y="465" width="240" height="110" rx="5" fill="#1a1a2e" stroke="#4ecca3" stroke-width="1"/>
  <text x="210" y="485" text-anchor="middle" fill="#4ecca3" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Pipeline Steps</text>
  <text x="100" y="505" fill="#888" font-family="monospace" font-size="10">1. lint</text>
  <text x="100" y="520" fill="#888" font-family="monospace" font-size="10">2. test:unit</text>
  <text x="100" y="535" fill="#888" font-family="monospace" font-size="10">3. test:integration</text>
  <text x="100" y="550" fill="#888" font-family="monospace" font-size="10">4. build</text>
  <text x="100" y="565" fill="#888" font-family="monospace" font-size="10">5. deploy (ansible)</text>
  
  <!-- Application Stack Section -->
  <rect x="370" y="360" width="460" height="230" rx="10" fill="url(#appGrad)" stroke="#e94560" stroke-width="2"/>
  <text x="600" y="385" text-anchor="middle" fill="#e94560" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Application Stack</text>
  
  <!-- Gateway -->
  <rect x="390" y="400" width="130" height="70" rx="5" fill="#e94560" filter="url(#shadow)"/>
  <text x="455" y="425" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Gateway</text>
  <text x="455" y="442" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">Fastify + Watt</text>
  <text x="455" y="458" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">:3042 (~300MB)</text>
  
  <!-- Keycloak -->
  <rect x="540" y="400" width="130" height="70" rx="5" fill="#e94560" filter="url(#shadow)"/>
  <text x="605" y="425" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Keycloak</text>
  <text x="605" y="442" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">OIDC/PKCE</text>
  <text x="605" y="458" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">:8080 (~1GB)</text>
  
  <!-- Redis -->
  <rect x="690" y="400" width="120" height="70" rx="5" fill="#dc382d" filter="url(#shadow)"/>
  <text x="750" y="425" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Redis</text>
  <text x="750" y="442" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10">Sessions</text>
  <text x="750" y="458" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">:6379 (~100MB)</text>
  
  <!-- PostgreSQL (future) -->
  <rect x="390" y="490" width="130" height="60" rx="5" fill="#336791" stroke="#fff" stroke-dasharray="4" filter="url(#shadow)"/>
  <text x="455" y="515" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">PostgreSQL</text>
  <text x="455" y="535" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">:5432 (future)</text>
  
  <!-- RabbitMQ (future) -->
  <rect x="540" y="490" width="130" height="60" rx="5" fill="#ff6600" stroke="#fff" stroke-dasharray="4" filter="url(#shadow)"/>
  <text x="605" y="515" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">RabbitMQ</text>
  <text x="605" y="535" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">:5672 (future)</text>
  
  <!-- Docker Network Label -->
  <text x="600" y="575" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="10">Docker Network: techcitizen-prod-network</text>
  
  <!-- Monitoring Section -->
  <rect x="850" y="360" width="280" height="230" rx="10" fill="url(#ciGrad)" stroke="#f9ed69" stroke-width="2"/>
  <text x="990" y="385" text-anchor="middle" fill="#f9ed69" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Observability</text>
  
  <!-- Prometheus -->
  <rect x="870" y="400" width="110" height="50" rx="5" fill="#e6522c" filter="url(#shadow)"/>
  <text x="925" y="420" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Prometheus</text>
  <text x="925" y="438" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">:9090 (~200MB)</text>
  
  <!-- Grafana -->
  <rect x="1000" y="400" width="110" height="50" rx="5" fill="#f9b716" filter="url(#shadow)"/>
  <text x="1055" y="420" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Grafana</text>
  <text x="1055" y="438" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="9">:3000 (~150MB)</text>
  
  <!-- Metrics flow -->
  <rect x="870" y="470" width="240" height="50" rx="5" fill="#1a1a2e" stroke="#f9ed69" stroke-width="1"/>
  <text x="990" y="490" text-anchor="middle" fill="#f9ed69" font-family="Arial, sans-serif" font-size="10">Metrics: /metrics endpoints</text>
  <text x="990" y="508" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="9">gateway, keycloak, redis, caddy</text>
  
  <!-- Loki (future) -->
  <rect x="870" y="535" width="110" height="45" rx="5" fill="#f9ed69" stroke="#fff" stroke-dasharray="4" filter="url(#shadow)"/>
  <text x="925" y="555" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Loki</text>
  <text x="925" y="570" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="8">(future logs)</text>
  
  <!-- Tempo (future) -->
  <rect x="1000" y="535" width="110" height="45" rx="5" fill="#f9ed69" stroke="#fff" stroke-dasharray="4" filter="url(#shadow)"/>
  <text x="1055" y="555" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Tempo</text>
  <text x="1055" y="570" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="8">(future traces)</text>
  
  <!-- Test Architecture Section -->
  <rect x="70" y="610" width="540" height="245" rx="10" fill="#1a1a2e" stroke="#00d4aa" stroke-width="2"/>
  <text x="340" y="635" text-anchor="middle" fill="#00d4aa" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Hexagonal Test Architecture</text>
  
  <!-- Test Pyramid -->
  <!-- E2E -->
  <polygon points="340,660 280,700 400,700" fill="#e94560" stroke="#fff" stroke-width="1"/>
  <text x="340" y="690" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">E2E 5%</text>
  
  <!-- Integration -->
  <polygon points="340,700 250,750 430,750" fill="#f9b716" stroke="#fff" stroke-width="1"/>
  <text x="340" y="735" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="10">Integration 20%</text>
  
  <!-- Unit -->
  <polygon points="340,750 200,820 480,820" fill="#4ecca3" stroke="#fff" stroke-width="1"/>
  <text x="340" y="795" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="12">Unit Tests 70%</text>
  
  <!-- Test descriptions -->
  <text x="520" y="675" fill="#e94560" font-family="Arial, sans-serif" font-size="10">Cucumber + Gherkin</text>
  <text x="520" y="725" fill="#f9b716" font-family="Arial, sans-serif" font-size="10">Testcontainers</text>
  <text x="520" y="790" fill="#4ecca3" font-family="Arial, sans-serif" font-size="10">Jest + In-memory fakes</text>
  
  <!-- Hexagonal layers mini -->
  <circle cx="130" cy="750" r="60" fill="none" stroke="#888" stroke-width="1"/>
  <circle cx="130" cy="750" r="40" fill="none" stroke="#888" stroke-width="1"/>
  <circle cx="130" cy="750" r="20" fill="#4ecca3"/>
  <text x="130" y="755" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="8">Domain</text>
  <text x="130" y="790" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="7">Application</text>
  <text x="130" y="820" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="7">Infrastructure</text>
  
  <!-- Ansible Section -->
  <rect x="630" y="610" width="230" height="245" rx="10" fill="#1a1a2e" stroke="#e94560" stroke-width="2"/>
  <text x="745" y="635" text-anchor="middle" fill="#e94560" font-family="Arial, sans-serif" font-size="14" font-weight="bold">IaC (Ansible)</text>
  
  <!-- Playbooks -->
  <rect x="650" y="655" width="190" height="185" rx="5" fill="#0f3460"/>
  <text x="660" y="675" fill="#4ecca3" font-family="monospace" font-size="10">playbooks/</text>
  <text x="670" y="695" fill="#888" font-family="monospace" font-size="9">├── bootstrap.yml</text>
  <text x="670" y="712" fill="#888" font-family="monospace" font-size="9">├── security-baseline.yml</text>
  <text x="670" y="729" fill="#888" font-family="monospace" font-size="9">├── docker-install.yml</text>
  <text x="670" y="746" fill="#888" font-family="monospace" font-size="9">├── deploy-gateway.yml</text>
  <text x="670" y="763" fill="#888" font-family="monospace" font-size="9">├── deploy-environment.yml</text>
  <text x="670" y="780" fill="#888" font-family="monospace" font-size="9">├── setup-caddy.yml</text>
  <text x="670" y="797" fill="#888" font-family="monospace" font-size="9">└── security-audit.yml</text>
  <text x="745" y="830" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="9">SSH → Production Server</text>
  
  <!-- Git Section -->
  <rect x="880" y="610" width="250" height="120" rx="10" fill="#1a1a2e" stroke="#f38020" stroke-width="2"/>
  <text x="1005" y="635" text-anchor="middle" fill="#f38020" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Source Control</text>
  
  <rect x="900" y="650" width="90" height="60" rx="5" fill="#333" filter="url(#shadow)"/>
  <text x="945" y="680" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="11" font-weight="bold">GitHub</text>
  <text x="945" y="698" text-anchor="middle" fill="#888" font-family="Arial, sans-serif" font-size="9">webhook</text>
  
  <text x="1005" y="680" fill="#4ecca3" font-family="Arial, sans-serif" font-size="20">→</text>
  
  <rect x="1020" y="650" width="90" height="60" rx="5" fill="#4ecca3" filter="url(#shadow)"/>
  <text x="1065" y="680" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Woodpecker</text>
  <text x="1065" y="698" text-anchor="middle" fill="#000" font-family="Arial, sans-serif" font-size="9">CI trigger</text>
  
  <!-- RAM Usage Summary -->
  <rect x="880" y="745" width="250" height="110" rx="10" fill="#1a1a2e" stroke="#888" stroke-width="1"/>
  <text x="1005" y="770" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="12" font-weight="bold">RAM Budget (8GB)</text>
  <text x="895" y="795" fill="#888" font-family="monospace" font-size="9">Base OS + Docker:  ~500MB</text>
  <text x="895" y="812" fill="#888" font-family="monospace" font-size="9">App Stack:        ~2.5GB</text>
  <text x="895" y="829" fill="#888" font-family="monospace" font-size="9">Monitoring:        ~350MB</text>
  <text x="895" y="846" fill="#4ecca3" font-family="monospace" font-size="9">CI (Woodpecker):   ~130MB</text>
  
  <!-- Connection lines -->
  <!-- Caddy to Gateway -->
  <line x1="500" y1="340" x2="455" y2="400" stroke="#00d4aa" stroke-width="1" stroke-dasharray="4"/>
  <!-- Caddy to Keycloak -->
  <line x1="600" y1="340" x2="605" y2="400" stroke="#00d4aa" stroke-width="1" stroke-dasharray="4"/>
  <!-- Caddy to Grafana -->
  <line x1="700" y1="340" x2="1055" y2="400" stroke="#00d4aa" stroke-width="1" stroke-dasharray="4"/>
  
  <!-- Gateway to Redis -->
  <line x1="520" y1="435" x2="690" y2="435" stroke="#e94560" stroke-width="1"/>
  <!-- Gateway to Keycloak -->
  <line x1="520" y1="420" x2="540" y2="420" stroke="#e94560" stroke-width="1"/>
  
  <!-- Prometheus scrapes -->
  <line x1="810" y1="435" x2="870" y2="425" stroke="#f9ed69" stroke-width="1" stroke-dasharray="2"/>
  
  <!-- CI to App (deploy) -->
  <line x1="350" y1="480" x2="390" y2="450" stroke="#4ecca3" stroke-width="1" stroke-dasharray="4"/>
  
  <!-- Legend -->
  <rect x="70" y="860" width="15" height="15" fill="#4ecca3"/>
  <text x="90" y="872" fill="#888" font-family="Arial, sans-serif" font-size="10">Active</text>
  
  <rect x="150" y="860" width="15" height="15" fill="none" stroke="#fff" stroke-dasharray="4"/>
  <text x="170" y="872" fill="#888" font-family="Arial, sans-serif" font-size="10">Future/Planned</text>
  
  <line x1="260" y1="867" x2="290" y2="867" stroke="#888" stroke-width="1" stroke-dasharray="4"/>
  <text x="295" y="872" fill="#888" font-family="Arial, sans-serif" font-size="10">Data flow</text>
</svg>
